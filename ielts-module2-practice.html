<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 2 Practice - Finding Ideas Fast | IELTS Speaking</title>

    <!-- External Stylesheets -->
    <link rel="stylesheet" href="styles/practice-interface.css">
    <link rel="stylesheet" href="styles/module2-practice.css">
</head>
<body>
    <div class="practice-container">
        <!-- Header -->
        <header class="practice-header">
            <h1>💡 Module 2: Finding Ideas Fast</h1>
            <div class="header-actions">
                <a href="ielts-speaking-lessons.html" class="back-button">⬅️ Back to Lessons</a>
            </div>
        </header>

        <!-- Compact Progress Bar -->
        <div class="compact-progress">
            <div class="progress-info">
                <span class="progress-count" id="progressText">0/100</span>
                <span class="progress-label">completed</span>
            </div>
            <div class="progress-bar-mini">
                <div class="progress-fill-mini" id="progressBar"></div>
            </div>
        </div>

        <!-- Collapsible Options -->
        <div class="options-panel">
            <button class="options-toggle" id="optionsToggle" onclick="toggleOptions()">
                ⚙️ Options (Modes & Filters)
            </button>
            <div class="options-content" id="optionsContent" style="display: none;">
                <!-- Practice Modes -->
                <div class="practice-modes">
                    <label class="options-label">Practice Mode:</label>
                    <button class="mode-button active" data-mode="sequential" id="modeSequential">📋 Sequential</button>
                    <button class="mode-button" data-mode="random" id="modeRandom">🎲 Random</button>
                    <button class="mode-button" data-mode="favorites" id="modeFavorites">⭐ Favorites</button>
                    <button class="mode-button" data-mode="incomplete" id="modeIncomplete">🔄 Incomplete</button>
                </div>

                <!-- Section Library Selector -->
                <div class="filter-section-inline">
                    <label class="options-label" for="sectionFilter">📚 Section Library:</label>
                    <select class="filter-select" id="sectionFilter">
                        <option value="all">All Practices (190 questions)</option>

                        <optgroup label="━━━ AUDIO LESSONS ━━━">
                            <option value="m2_intro">📚 The Idea Problem</option>
                            <option value="m2_5w1h">🎓 The 5W1H Method</option>
                            <option value="m2_demo">👨‍🏫 Teacher Demonstration</option>
                            <option value="m2_prep">📖 The PREP Method</option>
                            <option value="m2_past_present">⏮️ Past vs Present Comparison</option>
                            <option value="m2_personal_general">👤 Personal + General Approach</option>
                            <option value="m2_contrast">⚖️ The Contrast Technique</option>
                            <option value="m2_feelings">💙 Feelings + Reasons Method</option>
                            <option value="m2_frequency">⏰ Frequency + Details Method</option>
                        </optgroup>

                        <optgroup label="━━━ TECHNIQUE PRACTICES ━━━">
                            <option value="m2_practice2" selected>💯 5W1H Practice (100 questions)</option>
                            <option value="m2_prep_practice">🎯 PREP Method Practice (15 questions)</option>
                            <option value="m2_past_present_practice">⏭️ Past vs Present Practice (15 questions)</option>
                            <option value="m2_personal_general_practice">🌍 Personal + General Practice (15 questions)</option>
                            <option value="m2_contrast_practice">⚡ Contrast Technique Practice (15 questions)</option>
                            <option value="m2_feelings_practice">💕 Feelings + Reasons Practice (15 questions)</option>
                            <option value="m2_frequency_practice">📊 Frequency + Details Practice (15 questions)</option>
                        </optgroup>

                        <optgroup label="━━━ GUIDED EXERCISES ━━━">
                            <option value="m2_practice1">✏️ Your Turn: Generate Ideas (1 question)</option>
                            <option value="m2_compare">🔄 Compare Your Approach (interactive)</option>
                            <option value="m2_selection_guide">📐 Technique Selection Guide</option>
                            <option value="m2_mixed_practice">🎭 Mixed Practice (AI conversation)</option>
                        </optgroup>
                    </select>
                </div>

                <!-- Category Filter (only shown for 5W1H practice) -->
                <div class="filter-section-inline" id="categoryFilterSection">
                    <label class="options-label" for="categoryFilter">Category:</label>
                    <select class="filter-select" id="categoryFilter">
                        <option value="all">All Categories (100)</option>
                        <option value="hobbies">Hobbies & Interests</option>
                        <option value="daily">Daily Life</option>
                        <option value="sports">Activities & Sports</option>
                        <option value="technology">Technology & Media</option>
                        <option value="relationships">People & Relationships</option>
                        <option value="work">Learning & Work</option>
                        <option value="travel">Places & Travel</option>
                        <option value="food">Food & Cooking</option>
                        <option value="weather">Weather & Seasons</option>
                        <option value="shopping">Shopping & Fashion</option>
                        <option value="home">Home & Living</option>
                        <option value="arts">Arts & Entertainment</option>
                        <option value="nature">Nature & Environment</option>
                        <option value="transport">Transportation</option>
                        <option value="health">Health & Lifestyle</option>
                        <option value="celebrations">Celebrations & Festivals</option>
                        <option value="pets">Pets & Animals</option>
                        <option value="language">Language & Communication</option>
                        <option value="memory">Memory & Childhood</option>
                        <option value="time">Time Management</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Question Browser Panel -->
        <div class="question-browser-panel" id="questionBrowserPanel">
            <div class="browser-header">
                <button class="browser-toggle-btn" id="browserToggleBtn" onclick="toggleQuestionBrowser()">
                    <span class="toggle-icon" id="browserToggleIcon">▼</span>
                    <span class="toggle-text">📖 Browse Questions (<span id="browserQuestionCount">0</span> questions)</span>
                </button>
            </div>
            <div class="browser-content" id="browserContent" style="display: none;">
                <!-- View Toggle -->
                <div class="browser-controls">
                    <div class="view-toggle">
                        <button class="view-btn active" data-view="grid" onclick="switchBrowserView('grid')">▦ Grid</button>
                        <button class="view-btn" data-view="list" onclick="switchBrowserView('list')">☰ List</button>
                    </div>
                    <div class="browser-filters">
                        <span style="margin-right: 10px;">Filter:</span>
                        <button class="filter-btn active" data-filter="all" onclick="filterQuestions('all')">All</button>
                        <button class="filter-btn" data-filter="favorites" onclick="filterQuestions('favorites')">⭐ Favorites</button>
                        <button class="filter-btn" data-filter="completed" onclick="filterQuestions('completed')">✓ Completed</button>
                        <button class="filter-btn" data-filter="incomplete" onclick="filterQuestions('incomplete')">○ Incomplete</button>
                    </div>
                </div>

                <!-- Grid View -->
                <div class="browser-grid" id="browserGrid"></div>

                <!-- List View -->
                <div class="browser-list" id="browserList" style="display: none;"></div>
            </div>
        </div>

        <!-- Quick Navigation Bar -->
        <div class="quick-nav-bar" id="quickNavBar">
            <div class="nav-input-group">
                <label for="jumpToInput">Go to Q#:</label>
                <input type="number" id="jumpToInput" min="1" placeholder="#" style="width: 60px;" onkeypress="if(event.key==='Enter') jumpToQuestionByInput()">
                <button class="btn-small" onclick="jumpToQuestionByInput()">Go</button>
            </div>
            <div class="nav-buttons">
                <button class="btn-small" onclick="jumpToQuestion(0)" title="First question">⏮️ First</button>
                <button class="btn-small" onclick="jumpRelative(-10)" title="Back 10 questions">◀◀ -10</button>
                <button class="btn-small" onclick="previousQuestion()" title="Previous question">◀ Prev</button>
                <button class="btn-small" onclick="nextQuestion()" title="Next question">Next ▶</button>
                <button class="btn-small" onclick="jumpRelative(10)" title="Forward 10 questions">+10 ▶▶</button>
                <button class="btn-small" onclick="jumpToQuestion(practiceInterface.questions.length - 1)" title="Last question">⏭️ Last</button>
            </div>
            <div class="nav-smart-buttons">
                <button class="btn-small" onclick="jumpToRandom()">🎲 Random</button>
                <button class="btn-small" onclick="jumpToNextIncomplete()">⏭️ Next Incomplete</button>
            </div>
        </div>

        <!-- Question Card -->
        <div class="question-card" id="questionCard">
            <div class="question-header">
                <span class="question-number" id="questionNumber">Question 1/100</span>
                <span class="question-category" id="questionCategory">Category</span>
                <button class="favorite-button" id="favoriteButton" title="Add to favorites">☆</button>
            </div>

            <div class="question-text-large" id="questionText">Loading question...</div>

            <!-- Answer Input Section - Dynamic Form -->
            <div class="answer-section">
                <div class="section-header">
                    <h3 id="formTitle">📝 Your Answer</h3>
                    <p class="section-hint" id="formHint">Fill in the elements to build your answer</p>
                </div>

                <!-- Dynamic form container -->
                <div class="technique-form" id="techniqueFormContainer"></div>

                <!-- Answer Template Guide -->
                <div class="template-guide">
                    <div class="template-header">
                        <strong>📐 Answer Template:</strong>
                        <button class="template-toggle" id="templateToggleBtn" onclick="toggleTemplate()">Show</button>
                    </div>
                    <div class="template-content" id="templateContent" style="display: none;">
                        <p class="template-pattern">
                            I <span class="template-slot">[WHAT]</span>,
                            <span class="template-slot">[WHEN]</span>
                            <span class="template-slot">[WHERE]</span>
                            <span class="template-slot">[WHO]</span>.
                            <span class="template-slot">[WHY]</span>,
                            which makes me feel <span class="template-slot">[HOW]</span>.
                        </p>
                        <p class="template-note">
                            <strong>Example:</strong> I <strong>enjoy listening to jazz music</strong>,
                            <strong>particularly in the evenings</strong>
                            <strong>at home</strong>
                            <strong>alone</strong>.
                            <strong>Because it helps me relax</strong>,
                            which makes me feel <strong>calm and peaceful</strong>.
                        </p>
                    </div>
                </div>

                <!-- Real-time Answer Preview -->
                <div class="answer-preview">
                    <div class="preview-header">
                        <strong>💡 Your Complete Answer:</strong>
                        <span class="preview-hint">(Watch it build as you type!)</span>
                    </div>
                    <div class="preview-content" id="generatedAnswer">
                        <em>Start filling in the fields above to see your answer...</em>
                    </div>
                    <div class="preview-stats" id="previewStats">
                        <span class="stat-badge">0/6 elements used</span>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" id="getFeedbackBtn" onclick="getAIFeedback()">🤖 Get AI Feedback</button>
                <button class="btn btn-success" id="markCompleteBtn" onclick="markComplete()">✓ Mark Complete</button>
                <button class="btn btn-secondary" id="skipBtn" onclick="skipQuestion()">⏭️ Skip</button>
            </div>
        </div>

        <!-- Sample Answer Section -->
        <div class="sample-answer-card" style="display: none;">
            <button class="sample-answer-toggle-btn" id="toggleSampleBtn" onclick="toggleSampleAnswer()">
                <span class="toggle-icon">▼</span>
                <span class="toggle-text">💡 Compare with Band 7-7.5 Sample Answer</span>
            </button>
            <div class="sample-answer-box" id="sampleAnswerBox" style="display: none;">
                <!-- Technique Breakdown -->
                <div class="5w1h-breakdown">
                    <h4 id="breakdownTitle">📋 Elements Used:</h4>
                    <div class="breakdown-grid" id="breakdownGrid"></div>
                </div>

                <div class="breakdown-divider"></div>

                <!-- Full Sample Answer -->
                <div class="full-sample-answer">
                    <h4>📝 Complete Answer (Band 7-7.5):</h4>
                    <p class="sample-text" id="sampleAnswerText">Sample answer will appear here...</p>
                </div>

                <div class="sample-tip">
                    <strong>💡 Tip:</strong> Compare the breakdown above with your own answer. Try to include at least 3-4 elements naturally in your response.
                </div>
            </div>
        </div>

        <!-- AI Feedback Section -->
        <div class="feedback-section" id="feedbackSection" style="display: none;">
            <div class="feedback-header">💬 AI Teacher Feedback</div>
            <div class="feedback-content" id="feedbackContent">Feedback will appear here...</div>
        </div>

        <!-- Navigation -->
        <div class="navigation-buttons">
            <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()">⬅️ Previous</button>
            <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()">Next ➡️</button>
        </div>

        <!-- Keyboard Shortcuts Hint -->
        <div class="shortcuts-hint">
            <strong>Keyboard Shortcuts:</strong><br>
            <kbd>N</kbd> Next • <kbd>P</kbd> Previous • <kbd>S</kbd> Show Sample • <kbd>F</kbd> Get Feedback
        </div>
    </div>

    <!-- External Scripts -->
    <script src="scripts/ieltsLessons.js"></script>
    <script src="scripts/ieltsCoachAI.js"></script>
    <script src="scripts/practiceInterface.js"></script>
    <script src="scripts/module2-config.js"></script>
    <script src="scripts/module2-practice.js"></script>
</body>
</html>
